<?xml version="1.0" encoding="UTF-8"?>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
    <h:head>
        <title>Vasarnamių rezervacija</title>
        <h:outputStylesheet library="css" name="custom.css"/>
        <script src="//connect.facebook.net/en_US/sdk.js" type="text/javascript"/>
        <script src="https://code.jquery.com/jquery-2.2.2.min.js"   integrity="sha256-36cp2Co+/62rEAAYHLmRCPIych47CvdM+uTBJwSzWjI="   crossorigin="anonymous"></script>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous"/>
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap-theme.min.css" integrity="sha384-fLW2N01lMqjakBkx3l/M9EahuwpSfeNvV63J5ezn3uZzapT0u7EYsXMjQV+0En5r" crossorigin="anonymous"/>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js" integrity="sha384-0mSbJDEHialfmuBBQP6A4Qrprq5OVfW37PRR3j5ELqxss1yVqOtnepnHVP9aJ7xS" crossorigin="anonymous"></script>
        <script src="https://code.jquery.com/ui/1.11.4/jquery-ui.min.js"   integrity="sha256-xNjb53/rY+WmG+4L6tTl9m6PpqknWZvRt0rO1SRnJzw="   crossorigin="anonymous"></script> 
    </h:head>
    <h:body>
        <!-- Navigation panel-->
        <ui:include src="/WEB-INF/navigation.xhtml" />
       <!--Filter panel--> 
       <div class="container">
            <div class="row">
                <div class="col-sm-4 col-md-3 col-lg-3">
                    <h:form id="filterForm">
                        <p:accordionPanel id="filterAccordion" multiple="true">
                            <p:tab id="options" title="Parinktys">
                                <!--Dropdown orering--><!--Spinner place count-->
                                <h:panelGrid id="panelGrid" columns="2" >    
                                    <h:outputLabel for="ordering" value="Viršuje:" />
                                    <h:selectOneMenu id="ordering" value="#{houseFilter.ordering}" >
                                        <f:selectItems value="#{houseFilter.availableOrderings}" />
                                    </h:selectOneMenu>
                                    <h:outputLabel for="placeCount" value="Vietų skaičius:" />
                                    <p:spinner id="placeCount" value="#{houseFilter.placeCount}" min="0" max="99" size="1"/>
                                    <p:tooltip id="toolTipPlaceCount" for="placeCount" value="0 žymi visus vietų skaičius" trackMouse="true" />
                                </h:panelGrid>
                                
                                <!--Price slider-->
                                <p:outputLabel for="displayRange" value="Kaina:" /><br/>
                                <h:outputText id="displayRange" value="Nuo #{houseFilter.priceFrom}€ iki #{houseFilter.priceTo}€" />
                                <p:slider id="priceSlider" 
                                          for="priceFrom,priceTo" 
                                          display="displayRange" 
                                          style="width: 170px" 
                                          range="true" 
                                          displayTemplate="Kaina nuo {min}€ iki {max}€" 
                                          maxValue="#{houseFilter.maxHousePrice}" />
                                <h:inputHidden id="priceFrom" value="#{houseFilter.priceFrom}" />
                                <h:inputHidden id="priceTo" value="#{houseFilter.priceTo}" />

                                <br/>

                                <p:outputLabel for="panelGrid" value="Viešnagės periodas:" />
                                <p:tooltip id="calendarToolTip" for="dateFrom,dateTo" value="Nameliai nuomuojami savaitėmis (nuo pirmadienio iki sekmadienio imtinai)" trackMouse="true" />
                                <h:panelGrid id="dateGrid" columns="2" >
                                    <p:outputLabel for="dateFrom" value="Nuo: " />
                                    <p:calendar id="dateFrom" pattern="yyyy-MM-dd" size="10"
                                                beforeShowDay="calendarOnlyMonday" locale="lt"
                                                value="#{houseFilter.dateFrom}" 
                                                mindate="#{houseFilter.today}" 
                                                maxdate="#{houseFilter.endOfSeason}"  >
                                        <p:ajax event="dateSelect" listener="#{houseFilter.onDateSelect}" update="dateTo" />
                                    </p:calendar>
                                    <p:outputLabel for="dateTo" value="Iki: " />
                                    <p:calendar id="dateTo" pattern="yyyy-MM-dd" size="10"
                                                beforeShowDay="calendarOnlySunday" locale="lt"
                                                value="#{houseFilter.dateTo}" 
                                                mindate="#{houseFilter.dateFrom}"
                                                maxdate="#{houseFilter.endOfSeason}" >
                                        <p:ajax event="dateSelect" update="dateFrom" />
                                    </p:calendar>    
                                </h:panelGrid>
                            </p:tab>
                            
                            <!--Available services-->
                            <p:tab title="Paslaugos">
                                <p:selectManyCheckbox id="grid2" value="#{houseFilter.selectedFilters}" layout="pageDirection" columns="3">
                                    <f:selectItems value="#{houseFilter.availableFilters}" var="filter" itemLabel="#{filter}" itemValue="#{filter}" />
                                </p:selectManyCheckbox> 
                            </p:tab>
                        </p:accordionPanel>    
                        
                        <p:commandButton class="btn btn-primary" value="Filtruoti" action="#{summerhouseManager.filter()}" update="houseDataScroller" style="width: 100%"/>
                        <p:commandButton class="btn btn-success" value="Rodyti visus" action="#{summerhouseManager.showAll()}" update="houseDataScroller" style="width: 100%"/>   
                    </h:form>
                </div>
        
            <!--summerhouse data-->
                <div class="col-sm-8 col-md-9 col-lg-9">
                        <p:dataScroller id="houseDataScroller" value="#{summerhouseManager.filteredSummerhouses}" var="house" chunkSize="10" style="border:thin" >
                            <f:facet name="header" >
                                    Vasarnamiai
                            </f:facet>
                            <h:panelGrid columns="2" style="width: 100%" columnClasses="ui-grid-col-4,ui-grid-col-8" >
                                <p:graphicImage id="img" url="https://encrypted-tbn1.gstatic.com/images?q=tbn:ANd9GcQ34NdBFQhnN-roT0brsL-VFUnVVesw-KNTOJNTL0Al8b9-Ut0T" style="width: 100%;padding-right: 10px"/>
                                <p:outputPanel>

                                    <p:commandLink oncomplete="disableScrolling(),PF('houseDialog').show()" update=":houseDialogForm:houseDetail,:houseDialogForm:houseGalleria" >
                                        <f:setPropertyActionListener value="#{house}" target="#{summerhouseManager.selectedHouse}" />
                                        <h:outputText class="title-text" value="#{house.title}"/>
                                    </p:commandLink>

                                    <h:panelGrid columns="1" style="width: 100%" columnClasses="forty-percent top-alignment, sixty-percent top-alignment" >
                                        <h:outputText class="small-text" value="Adresas: #{house.address}"/>
                                        <h:outputText class="small-text" value="Vietos: #{house.numberofplaces}"/>
                                    </h:panelGrid>
                                    <h:outputText class="price-text" style="width: 100%" value="#{house.weekprice}€"/>

                                </p:outputPanel>
                            </h:panelGrid>
                            <hr/>
                        </p:dataScroller>
                    <h:form id="houseDialogForm" >    
                        <p:dialog id="houseDetail" header="#{summerhouseManager.selectedHouse.title}"
                                  width="300" height="300"
                                  modal="true" showEffect="clip" widgetVar="houseDialog"
                                  resizable="false" draggable="false" responsive="true"
                                  closeOnEscape="true" fitViewport="true" position="center"
                                  onHide="enableScrolling()">
                            <p:outputPanel >
                                <p:galleria id="houseGalleria" value="#{summerhouseManager.houseImages}" var="image" 
                                            style="width: 100%" panelHeight="180" panelWidth="250"
                                            showFilmstrip="true" autoPlay="false" showCaption="false">
                                    <p:graphicImage url="#{image}" alt="Image Description for #{image}" style="width: 100%"/>
                                </p:galleria>
                                <!--Nuotraukos-->
                                #{summerhouseManager.selectedHouse.weekprice}
                            </p:outputPanel>
                        </p:dialog>
                    </h:form> 
                </div>
            </div>
        </div>
        
        

        
        <!-- scripts -->
        <h:outputScript library="js" name="custom.js" />
        <script>setActiveNavTab("summerhouses")</script>
        <!-- end of scripts -->
    </h:body>
</html>
